% hw2a.tex - Comp356 HW 2A Answers

% Declare page size and style.
\documentclass[a4paper, 12pt]{article}
\pagestyle{plain}
\usepackage{fullpage}

% Declare which packages to use..
\usepackage{amsmath}
\usepackage{amssymb}

% Define custom commands for the document.
\newcommand{\abs}[1]{\lvert#1\rvert}
\newcommand{\norm}[1]{\lVert#1\rVert}

\input{./utils.tex}

\begin{document}
\hwheader{Comp 356: Computer Graphics\\Homework 2A: Ray-tracing geometry}

\begin{enumerate}
    \item \textbf{Problem:} Assuming the standard camera frame based on the viewpoint, look-at point, and up- direction, compute the camera frame basis expressed as linear combinations of the standard basis.  Your camera frame basis must be orthonormal.

        \textbf{Solution:} First, we must compute the vectors that will compose our basis \(\vec{u}, \vec{v}, \vec{w}\).
        \(\vec{w}\) is opposite the view direction so
        %Compute w
        \begin{align*}
        \vec{w} =& \frac{\vec{e} - \vec{P}}{\norm{\vec{e} - \vec{P}}}\\
        \vec{e} - \vec{P} =& (4,4,4) - (-1,-1,-1) = (3,3,3)\\
        \vec{w} =& \frac{(3,3,3)}{\norm{(3,3,3)}} = \frac{(3,3,3)}{\sqrt{3^2 + 3^2 + 3^2}} = \fbox{$(\frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}})$}\\
        %Compute u
        \vec{u} =& \frac{\vec{up} \times \vec{w}}{\norm{\vec{up} \times \vec{w}}}\\
        \vec{up} \times \vec{w} =& (0,1,0) \times (\frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}})\\
        \vec{up} \times \vec{w} =& (1\frac{1}{\sqrt{3}} - 0\frac{1}{\sqrt{3}}, 0\frac{1}{\sqrt{3}} - 0\frac{1}{\sqrt{3}}, 0\frac{1}{\sqrt{3}} - 1\frac{1}{\sqrt{3}}) = (\frac{1}{\sqrt{3}}, 0, -\frac{1}{\sqrt{3}}) \\
        \vec{u} =& \frac{(\frac{1}{\sqrt{3}}, 0, -\frac{1}{\sqrt{3}})}{\norm{(\frac{1}{\sqrt{3}}, 0, -\frac{1}{\sqrt{3}}}} = \frac{(\frac{1}{\sqrt{3}}, 0, -\frac{1}{\sqrt{3}})}{\sqrt{\frac{1}{\sqrt{3}}^2 + 0^2 - \frac{1}{\sqrt{3}}^2}} = \frac{(\frac{1}{\sqrt{3}}, 0, -\frac{1}{\sqrt{3}})}{\sqrt{\frac{2}{3}}} = \fbox{$(\frac{1}{\sqrt{2}}, 0, -\frac{1}{\sqrt{2}})$}\\
        %Compute v
        \vec{v} =& \vec{w} \times \vec{u} = (\frac{1}{\sqrt{2}}, 0, -\frac{1}{\sqrt{2}}) \times (\frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}})\\
        &\text{Dot product calculation is same as above, omitted for brevity.}\\
        \vec{v} =& \fbox{$(-\frac{1}{\sqrt{6}}, \frac{2}{\sqrt{6}}, -\frac{1}{\sqrt{6}} $}\\
        %Show as linear combination of standard basis
        &\text{These vectors form the orthonormal basis for the camera frame and}\\
        &\text{can be expressed as linear combinations of the standard basis:}\\
        \vec{u} =& \frac{1}{\sqrt{2}}\vec{i} + 0\vec{j} -\frac{1}{\sqrt{2}}\vec{k}\\
        \vec{v} =& -\frac{1}{\sqrt{6}}\vec{i} + \frac{2}{\sqrt{6}}\vec{j} -\frac{1}{\sqrt{6}}\vec{k}\\
        \vec{w} =& \frac{1}{\sqrt{3}}\vec{i} + \frac{1}{\sqrt{3}}\vec{j} + \frac{1}{\sqrt{3}}\vec{k}\\
        \end{align*}

    \item \textbf{Problem:} Assuming the standard viewing rectangle that lies in a plane that is orthogonal to \(\vec{w}\) and such that \(\vec{e} - t\vec{w}\) intersects the viewing rectangle in its center, give the coordinates of the lower-left and upper-right corners of the view rectangle in the world frame.

        \textbf{Solution:} Let the view rectangle have width (W) = 8 units and height (H) = 6 units and be located 1 unit from the view point (so d = 1). The lower-left coordinate of the view rectangle is \( ( $-$\frac{W}{2}, $-$\frac{H}{2}, $-$d) \) and the upper-right coordinate is \( (\frac{W}{2}, \frac{H}{2}, $-$d) \). However, the view rectangle is defined in the camera frame $\vec{u}$, $\vec{v}$, $\vec{w}$ so the lower-left point expressed as a linear combination of the camera frame is:
        \begin{align*}
            &-\frac{W}{2}\vec{u} - \frac{H}{2}\vec{v} -d\vec{w}\\
            &\text{W=8, H=6, d=1, so we get}\\
            &= -4\vec{u} - 3\vec{v} -1\vec{w}\\
            &\text{We now perform a change of basis to the world frame}\\
            P_{lower left} &= \text{viewpoint $\vec{e}$} + (-4\vec{u} - 3\vec{v} -1\vec{w})\\
            P_{lower left} &= \vec{e} -4\vec{u} - 3\vec{v} -1\vec{w})\\
            P_{lower left} &= \vec{e} -4\left(\frac{1}{\sqrt{2}}\vec{i} + 0\vec{j} -\frac{1}{\sqrt{2}}\vec{k}\right) - 3\left( -\frac{1}{\sqrt{6}}\vec{i} + \frac{2}{\sqrt{6}}\vec{j} -\frac{1}{\sqrt{6}}\vec{k} \right) - 1\left(\frac{1}{\sqrt{3}}\vec{i} + \frac{1}{\sqrt{3}}\vec{j} + \frac{1}{\sqrt{3}}\vec{k}\right)\\
            P_{lower left} &= \vec{e} + \left( \frac{-4}{\sqrt{2}} + \frac{3}{\sqrt{6}} -\frac{1}{\sqrt{3}} \right) \vec{i} + \left(\frac{-6}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{j} + \left( \frac{4}{\sqrt{2}} +\frac{3}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{k}\\
            P_{lower left} &= 4\vec{i}, 4\vec{j}, 4\vec{k} + \left( \frac{-4}{\sqrt{2}} + \frac{3}{\sqrt{6}} -\frac{1}{\sqrt{3}} \right) \vec{i} + \left(\frac{-6}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{j} + \left( \frac{4}{\sqrt{2}} +\frac{3}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{k}\\
            P_{lower left} &= 1.819\vec{i} + 0.973\vec{j} + 7.476\vec{k}\\
            &\text{And so the coordinates of the lower left corner in world frame are:}\\
            P_{lower left} &= (1.819, 0.973, 7.476)\\
        \end{align*}
        And we repeat this process to find the upper-right corner coordinate, beginning with it being defined in the camera frame as \( (\frac{W}{2}, \frac{H}{2}, -d) \).
        \begin{align*}
            &\frac{W}{2}\vec{u} + \frac{H}{2}\vec{v} -d\vec{w}\\
            &\text{W=8, H=6, d=1, so we get}\\
            &= 4\vec{u} + 3\vec{v} -1\vec{w}\\
            &\text{We now perform a change of basis to the world frame}\\
            P_{upper right} &= \text{viewpoint $\vec{e}$} + (4\vec{u} + 3\vec{v} -1\vec{w})\\
            P_{upper right} &= \vec{e} + 4\vec{u} + 3\vec{v} -1\vec{w})\\
            P_{upper right} &= \vec{e} + 4\left(\frac{1}{\sqrt{2}}\vec{i} + 0\vec{j} -\frac{1}{\sqrt{2}}\vec{k}\right) + 3\left(-\frac{1}{\sqrt{6}}\vec{i} + \frac{2}{\sqrt{6}}\vec{j} -\frac{1}{\sqrt{6}}\vec{k}\right) - 1\left(\frac{1}{\sqrt{3}}\vec{i} + \frac{1}{\sqrt{3}}\vec{j} + \frac{1}{\sqrt{3}}\vec{k}\right)\\
            P_{upper right} &= \vec{e} + \left( \frac{4}{\sqrt{2}} - \frac{3}{\sqrt{6}} -\frac{1}{\sqrt{3}} \right) \vec{i} + \left( \frac{6}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{j} + \left( -\frac{4}{\sqrt{2}} -\frac{3}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{k}\\
            P_{upper right} &= 4\vec{i}, 4\vec{j}, 4\vec{k} + \left( \frac{4}{\sqrt{2}} - \frac{3}{\sqrt{6}} -\frac{1}{\sqrt{3}} \right) \vec{i} + \left( \frac{6}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{j} + \left( -\frac{4}{\sqrt{2}} -\frac{3}{\sqrt{6}} - \frac{1}{\sqrt{3}} \right) \vec{k}\\
            P_{upper right} &= 5.026\vec{i} + 8.872\vec{j} + -0.631\vec{k}\\
            &\text{And so the coordinates of the upper right corner in world frame are:}\\
            P_{upper right} &= (5.026, 8.872, -0.631)\\
            \end{align*}
        \item \textbf{Problem:} Let $\vec{r}$ = $\vec{e}$ + t$\vec{d}$ be the viewing ray through pixel (400, 300). What is $\vec{d}$ in the world frame?

        \textbf{Solution:}We first map the screen pixel (400, 300) to a point (in the camera frame) on our view rectangle of 800 $\times$ 600 pixels. The vector from viewpoint $\vec{e}$ to this point on the view rectangle is $\vec{d}$, and we lastly show it in the world frame.
    \begin{align*}
        &\text{The pixel$(i, j)$ maps to following point on the view rectangle (in camera frame):}\\
        &\left( -\frac{W}{2} + \frac{i + 0.5}{n_x}W, -\frac{H}{2} + \frac{j + 0.5}{n_y}H, -d \right) \text{ so}\\
        &Pixel(400, 300) : \left( -\frac{8}{2} + \frac{400 + 0.5}{800}8, -\frac{6}{2} + \frac{300 + 0.5}{600}6, -1 \right)\\
        &= (0.005, 0.005, -1)\\
    \end{align*}
        Because $\vec{e}$ is the origin of the camera frame, this point on the view rectangle is the same as the vector from the origin to the point. So this is $\vec{d}$ in the camera frame. We now perform a change of basis to standard basis (similarly to Problem 2 above).
        \begin{align*}
            \vec{d} &= (0.005, 0.005, -1) = 0.005\vec{u} + 0.005\vec{v} - 1\vec{w}\\
            \vec{d} &= 0.005\left( \frac{1}{\sqrt{2}}\vec{i} + 0\vec{j} -\frac{1}{\sqrt{2}}\vec{k} \right) + 0.005\left(-\frac{1}{\sqrt{6}}\vec{i} + \frac{2}{\sqrt{6}}\vec{j} -\frac{1}{\sqrt{6}}\vec{k} \right) - 1\left( \frac{1}{\sqrt{3}}\vec{i} + \frac{1}{\sqrt{3}}\vec{j} + \frac{1}{\sqrt{3}}\vec{k} \right)\\
            \vec{d} &= -.576\vec{i} - .573\vec{j} -.583\vec{k}\\
    \end{align*}

    \item \textbf{Problem:} If $\vec{r}$ is the viewing ray through pixel (400, 300), at what time does $\vec{r}$ intersect the sphere centered at the origin with radius 1? What are the coordinates of the intersection point?  What is the surface normal at the intersection point?
        \textbf{Solution:} $\vec{p}(t) = \vec{e} + t\vec{d}$ The sphere is centered at the origin, so $\vec{c}$ = (0, 0, 0) On page 77 of our text, we have a large quadratic formula for solving for t. It is:
        \begin{align*}
            t =& \frac{-\vec{d}\cdot(\vec{e}-\vec{c}) \pm \sqrt{(\vec{d}\cdot(\vec{e}-\vec{c}))^2 - (\vec{d}\cdot\vec{d})\left( (\vec{e}-\vec{c})\cdot(\vec{e}-\vec{c}) - R^2 \right)}}{\vec{d}\cdot\vec{d}}\\
            &\text{We note that $\vec{c}$ is at the origin so $\vec{e} - \vec{c} = \vec{e}$.}\\
            t =& \frac{-\vec{d}\cdot\vec{e} \pm \sqrt{(\vec{d}\cdot(\vec{e})^2 - (\vec{d}\cdot\vec{d})\left( \vec{e}\cdot\vec{e} - R^2 \right)}}{\vec{d}\cdot\vec{d}}\\
            &\text{We begin plugging in values and get:}\\
            t =& \frac{6.928 \pm \sqrt{47.999 - (0.999)\left( 48 - 1^2 \right)}}{0.999}\\
            t =& \frac{6.928 \pm \sqrt{1.046}}{0.999}\\
            t =& 7.959\\
            t =& 5.911\\
            &\text{So the coordinates of the first intersection are:}\\
            p(5.911) =& \vec{e} + (5.911)\vec{d} = (.595, .613, .554)\\
            &\text{And the coordinates of the second intersection are:}\\
            p(7.959) =& \vec{e} + (7.959)\vec{d} = (-.584, -.560, -.640)\\
            &\text{The second intersection point is on the back of the sphere,}\\
            &\text{so our main intersection point is the first one of (.595, .613, .554)}\\
            &\text{The surface normal at this first point is:}\\
            \vec{n} =& \frac{(\vec{p} - \vec{c}}{\norm{\vec{p} - \vec{c}}} = \frac{\vec{p}}{\norm{\vec{p}}} = \frac{(.595, .613, .554)}{\sqrt{(.595^2 + .613^2 + .554^2}} = (.584, .602, .554)\\
        \end{align*}




\end{enumerate}
\end{document}
